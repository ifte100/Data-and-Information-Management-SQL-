CREATE TABLE BRANCH
(
  BRANCH_ID CHAR(3) NOT NULL,
  BRANCH_NAME VARCHAR(20),
  BRANCH_ADDRESS VARCHAR(30),
  PHONE_NUMBER  CHAR(10),
  PRIMARY KEY (BRANCH_ID));


  INSERT INTO BRANCH
  VALUES('001', 'MELB', '1/22 HUNTINGDALE ROAD', '0412121212' );

  INSERT INTO BRANCH
  VALUES('002', 'ADEL', '2/13 BRABUS ROAD', '0413131313' );

  INSERT INTO BRANCH
  VALUES('003', 'BRISB', '1/66 JEROMAINE AVENUE', '0414141414' );

  INSERT INTO BRANCH
  VALUES('004', 'SYD', '5/11 JOHNSON CIRCLE', '0415151515' );

CREATE TABLE STAFF
(STAFF_ID INT NOT NULL PRIMARY KEY,
FIRST_NAME VARCHAR(15),
LAST_NAME VARCHAR(15),
ADDRESS VARCHAR(30),
PHONE_NUMBER CHAR(10),
EMAIL VARCHAR(20),
EMERGENCY_CONTACT CHAR(10),
POSITION VARCHAR(15),
SALARY INT,
BRANCH_ID CHAR(3),
FOREIGN KEY (BRANCH_ID) REFERENCES BRANCH(BRANCH_ID)
);

INSERT INTO STAFF
VALUES('1', 'MEGAN', 'SPOON', '2/23 RYERSON AVENUE', '0468231231', 'megan123@hotmail.com', '0427671554', 'MANAGER', '50000', '001');
INSERT INTO STAFF
VALUES('4', 'RAY', 'ANDERSON', '1/12 LARA AVENUE', '0418231231', 'ray123@hotmail.com', '0427611554', 'RETAIL ASSISTANT', '3000', '001');
INSERT INTO STAFF
VALUES('5', 'OMAR', 'KHALIF', '3/13 BIG ROAD', '0168231231', 'omar123@hotmail.com', '0422671554', 'RETAIL ASSISTANT', '4000', '001');
INSERT INTO STAFF
VALUES('9', 'HELIO', 'ARMAN', '2/1 SPENCER STREET', '0168211231', 'helio123@hotmail.com', '0452671554', 'INTERNATIONAL AFFAIR', '20000', '001');

INSERT INTO STAFF
VALUES('2', 'REESE', 'WITHERSPOON', '6/16 RYERSON AVENUE', '0468231731', 'reese123@hotmail.com', '0427671514', 'RETAIL ASSISTANT', '5000', '002');
INSERT INTO STAFF
VALUES('6', 'JADU', 'RAMIEN', '9/11 SPLITS ROAD', '0568331231', 'jadu123@hotmail.com', '0422171554', 'RETAIL ASSISTANT', '4000', '002');
INSERT INTO STAFF
VALUES('7', 'ELENA', 'POTROVA', '3/73 JUNCTION LANE', '0168231231', 'elena123@hotmail.com', '0422671554', 'INTERNATIONAL AFFAIR', '36000', '002');
INSERT INTO STAFF
VALUES('11', 'ENZO', 'FERRARI', '2/54 PINT ROAD', '0868231231', 'enzo123@hotmail.com', '0422671954', 'MANAGER', '25000', '002');

INSERT INTO STAFF
VALUES('3', 'ANGELINA', 'JOLIE', '1/54 TERRAIN ROAD', '0468931231', 'angel123@hotmail.com', '0427671154', 'INTERNATIONAL AFFAIR', '20000', '003');
INSERT INTO STAFF
VALUES('8', 'BRICK', 'LANE', '4/13 BOURKE STREET', '0168231231', 'brick123@hotmail.com', '0422672554', 'MANAGER', '50000', '003');
INSERT INTO STAFF
VALUES('10', 'ALI', 'NEWAZ', '4/13 UBER ROAD', '0168331231', 'ali123@hotmail.com', '0422671554', 'RETAIL ASSISTANT', '5000', '003');
INSERT INTO STAFF
VALUES('12', 'DIDI', 'DROGBA', '1/99 BRYANTS ROAD', '0968231231', 'didi123@hotmail.com', '0422672554', 'RETAIL ASSISTANT', '4000', '003');

INSERT INTO STAFF
VALUES('13', 'MATT', 'DUSKE', '1/1 BURWOOD HIGHWAY', '0768231231', 'matt123@hotmail.com', '0422611554', 'INTERNATIONAL AFFAIR', '25000', '004');
INSERT INTO STAFF
VALUES('14', 'MATT', 'FLETCHER', '3/13 BURWOOD HIGHWAY', '0668231231', 'flet123@hotmail.com', '0322671554', 'RETAIL ASSISTANT', '6000', '004');
INSERT INTO STAFF
VALUES('15', 'ARMAAN', 'ZAMAN', '9/13 BIG ROAD', '0368231231', 'arman123@hotmail.com', '0422671555', 'RETAIL ASSISTANT', '5000', '004');
INSERT INTO STAFF
VALUES('16', 'AMBER', 'ROSY', '5/5 ANTS AVENUE', '0568231231', 'amber123@hotmail.com', '0422671559', 'MANAGER', '30000', '004');


SELECT STAFF_ID, FIRST_NAME, POSITION, SALARY, BRANCH_ID
FROM STAFF
WHERE BRANCH_ID = '001'
ORDER BY SALARY DESC;

SELECT STAFF_ID, FIRST_NAME, POSITION, SALARY, BRANCH_ID
FROM STAFF
WHERE &CONDITION
ORDER BY SALARY DESC;

CREATE TABLE CUSTOMER
(
  CUSTOMER_ID INT NOT NULL PRIMARY KEY,
  FIRST_NAME VARCHAR(15),
  LAST_NAME VARCHAR(15),
  ADDRESS VARCHAR(30),
  PHONE_NUMBER CHAR(10),
  EMAIL VARCHAR(20),
  LICENSE_NUMBER VARCHAR(6),
  PIN INT,
  REGISTRATION_DATE DATE,
  BRANCH_ID CHAR(3),
  FOREIGN KEY (BRANCH_ID) REFERENCES BRANCH(BRANCH_ID)
);

  INSERT INTO CUSTOMER
  VALUES('1', 'JEAN', 'ORLANDO', '23 BRON STREET', '0418231231', 'jean123@hotmail.com', 'HEL123', '12345', '01-JAN-19','001');
  INSERT INTO CUSTOMER
  VALUES('2', 'HARRY', 'JEAN', '21 BROCK AVENUE', '0118231231', 'harry123@hotmail.com', 'UEL123', '12346', '02-JAN-19','001');
  INSERT INTO CUSTOMER
  VALUES('3', 'ROY', 'ANN', '123 HELL AVENUE', '0412231231', 'roy123@hotmail.com', 'ELO123', '12347', '01-JAN-18','001');
  INSERT INTO CUSTOMER
  VALUES('4', 'EREN', 'JAEGER', '67 UBER STREET', '0428231231', 'eren123@hotmail.com', 'HEL234', '12348', '02-JAN-18','002');
  INSERT INTO CUSTOMER
  VALUES('5', 'VUSI', 'SIBANDA', '12 READ ROAD', '0418231232', 'vusi123@hotmail.com', 'ELO223', '12349', '01-JAN-17','002');
  INSERT INTO CUSTOMER
  VALUES('6', 'ORAN', 'LALA', '23 BRON STREET', '0418241231', 'oran123@hotmail.com', 'LEO123', '12340', '25-JAN-19','002');
  INSERT INTO CUSTOMER
  VALUES('7', 'AKSHAY', 'KUMAR', '100 BOURKE STREET', '0419231231', 'aksh123@hotmail.com', 'YOU123', '13345', '01-FEB-19','003');
  INSERT INTO CUSTOMER
  VALUES('8', 'DAN', 'OKRA', '1 ELEVEN STREET', '0518231231', 'dan123@hotmail.com', 'ME123', '14345', '01-FEB-18','003');
  INSERT INTO CUSTOMER
  VALUES('9', 'LEILA', 'STAR', '23 BOURKE STREET', '0418231211', 'leila123@hotmail.com', 'HEL143', '15345', '05-JAN-17','003');
  INSERT INTO CUSTOMER
  VALUES('10', 'ANN', 'MARIE', '65 TINT ROAD', '0419231231', 'ann123@hotmail.com', 'MO1123', '16345', '10-JAN-19','004');
  INSERT INTO CUSTOMER
  VALUES('11', 'DUA', 'LIPA', '34 KOL STREET', '0428231231', 'dua123@hotmail.com', 'HEL333', '17345', '21-MAR-19','004');
  INSERT INTO CUSTOMER
  VALUES('12', 'ELIAS', 'SUNNY', '32 MICHAL STREET', '0918231231', 'elias123@hotmail.com', 'HEL193', '18345', '01-OCT-18','004');


CREATE TABLE OWNER
(
  OWNER_ID INT NOT NULL,
  FIRST_NAME VARCHAR(15),
  LAST_NAME VARCHAR(15),
  ADDRESS VARCHAR(30),
  PHONE_NUMBER CHAR(10),
  PRIMARY KEY(OWNER_ID));

  INSERT INTO OWNER
  VALUES('111', 'RIHANNA', 'RIRI', '2 BRON STREET', '0418231131');
  INSERT INTO OWNER
  VALUES('222', 'JANET', 'JACKSON', '100 BROCK AVENUE', '0618231231');
  INSERT INTO OWNER
  VALUES('333', 'EMIR', 'SULTAN', '123 HELL AVENUE', '0412431231');
  INSERT INTO OWNER
  VALUES('444', 'OLA', 'AMIGO', '12 UBER STREET', '0321231231');
  INSERT INTO OWNER
  VALUES('555', 'NAHIAN', 'JAMAL', '55 READ ROAD', '0119231232');
  INSERT INTO OWNER
  VALUES('666','MOMO','RAJI','12 DE STREET', '2143343441');
  INSERT INTO OWNER
  VALUES('777','GARRETT','BENJAMIN','43 DULCE ROAD','4532145631');

CREATE TABLE CAR
(
  CAR_REGISTRATION_ID VARCHAR(6) NOT NULL PRIMARY KEY,
  MAKE VARCHAR(10),
  MODEL VARCHAR(10),
  TYPE VARCHAR(10),
  RENTAL_RATE INT,
  LUXURIOUS CHAR(10),
  OWNER_ID INT,
  BRANCH_ID CHAR(3),
  FOREIGN KEY (BRANCH_ID) REFERENCES BRANCH(BRANCH_ID),
  FOREIGN KEY (OWNER_ID) REFERENCES OWNER(OWNER_ID)
);

INSERT INTO CAR
VALUES('AB535', 'TOYOTA', 'YARIS','SEDAN','100','NORMAL','111','001');
INSERT INTO CAR
VALUES('AC535', 'MITSUBISHI', 'LANCER','SEDAN','150','NORMAL','111','002');
INSERT INTO CAR
VALUES('AD535', 'HOLDEN', 'CAPTIVA','HATCHBACK','80','NORMAL','222','003');
INSERT INTO CAR
VALUES('AE535', 'KIA', 'SPORTAGE','SUV','100','NORMAL','333','001');
INSERT INTO CAR
VALUES('AF535', 'VOLKSWAGEN', 'PASSAT','HATCHBACK','130','NORMAL','444','002');
INSERT INTO CAR
VALUES('AG535', 'NISSAN', 'SKYLINE','SEDAN','160','NORMAL','555','003');
INSERT INTO CAR
VALUES('AH535', 'FERRARI', 'ENZO','COUPE','400','LUXURIOUS','666','003');
INSERT INTO CAR
VALUES('AI535', 'FORD', 'MUSTANG','COUPE','300','LUXURIOUS','777','002');
INSERT INTO CAR
VALUES('AJ535', 'LAMBO', 'GALLARDO','COUPE','500','LUXURIOUS','777','004');
INSERT INTO CAR
VALUES('AK535', 'DAIHATSU', 'DRAGON','SEDAN','50','NORMAL','222','004');

CREATE TABLE PAYMENT
(
  PAYMENT_ID INT NOT NULL PRIMARY KEY,
  CARD_NUMBER CHAR(16),
  TOTAL_PAYMENT NUMBER(9,2),
  CUSTOMER_ID INT,
  FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER(CUSTOMER_ID)
);

INSERT INTO PAYMENT
VALUES('123', '1234567891011121', '200','1');
INSERT INTO PAYMENT
VALUES('124', '1234567891011122', '600','2');
INSERT INTO PAYMENT
VALUES('125', '1234567891011123', '700','3');
INSERT INTO PAYMENT
VALUES('126', '1234567891011124', '1250','4');
INSERT INTO PAYMENT
VALUES('127', '1234567891011125', '330','5');
INSERT INTO PAYMENT
VALUES('128', '1234567891011126', '330','6');
INSERT INTO PAYMENT
VALUES('129', '1234567891011127', '330','7');


CREATE TABLE LOGBOOK
(
  LOG_ID INT NOT NULL PRIMARY KEY,
  BRANCH_ID CHAR(3),
  CUSTOMER_ID INT,
  CAR_REGISTRATION_ID VARCHAR(6),
  RENTING_OUT_DATE DATE,
  RETURNING_DATE DATE,
  TOTAL_PAYMENT NUMBER(9,2),
  FINES VARCHAR(5),
  FOREIGN KEY (BRANCH_ID) REFERENCES BRANCH(BRANCH_ID),
  FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER(CUSTOMER_ID),
  FOREIGN KEY (CAR_REGISTRATION_ID) REFERENCES CAR(CAR_REGISTRATION_ID)
);

INSERT INTO LOGBOOK
VALUES('9819', '001', '1', 'AB535', '21-JAN-19','22-JAN-19','100', 'NO');
INSERT INTO LOGBOOK
VALUES('9869', '001', '6', 'AF535', '25-JAN-19','26-JAN-19','130', 'NO');
INSERT INTO LOGBOOK
VALUES('9879', '001', '7', 'AG535', '27-JAN-19','28-JAN-19','160', 'NO');
INSERT INTO LOGBOOK
VALUES('9829', '002', '2', 'AC535', '23-JAN-19','24-JAN-19','150', 'NO');
INSERT INTO LOGBOOK
VALUES('9839', '003', '3', 'AD535', '21-JAN-19','22-JAN-19','80', 'NO');
INSERT INTO LOGBOOK
VALUES('9849', '004', '4', 'AE535', '29-JAN-19','01-FEB-19','300', 'NO');
INSERT INTO LOGBOOK
VALUES('9859', '004', '5', 'AH535', '03-FEB-19','8-FEB-19','2000', 'NO');

SELECT FIRST_NAME, SALARY
FROM STAFF
WHERE SALARY >= '20000'
AND SALARY <= '50000'
ORDER BY SALARY DESC;

UPDATE STAFF
SET SALARY = SALARY * 1.05
WHERE POSITION = 'MANAGER';

SELECT STAFF_ID, FIRST_NAME, POSITION, SALARY/12 AS MONTHLY_SALARY, BRANCH_ID
FROM STAFF
WHERE &CONDITION
ORDER BY SALARY DESC;

SELECT STAFF_ID, FIRST_NAME, POSITION, SALARY, BRANCH_ID
FROM STAFF
WHERE &CONDITION
ORDER BY SALARY DESC;

SELECT COUNT(STAFF_ID)
FROM STAFF
WHERE &CONDITION;

SELECT AVG(SALARY)
FROM STAFF
WHERE &CONDITION;

SELECT MIN(SALARY)
FROM STAFF
WHERE &CONDITION;

SELECT MAX(SALARY)
FROM STAFF
WHERE &CONDITION;


SELECT * FROM CUSTOMER
WHERE &CONDITION
ORDER BY LAST_NAME;

SELECT * FROM CAR
WHERE LUXURIOUS = 'LUXURIOUS';

SELECT CUSTOMER_ID, BRANCH_ID, TOTAL_PAYMENT FROM LOGBOOK
WHERE &CONDITION
ORDER BY TOTAL_PAYMENT;

SELECT * FROM CAR
WHERE &CONDITION;

SELECT FIRST_NAME, EMAIL, BRANCH_ID, TYPE, MODEL, CAR_REGISTRATION_ID, RENTING_OUT_DATE, RETURNING_DATE
FROM (CUSTOMER JOIN CAR
ON CUSTOMER.FIRST_NAME = CAR.TYPE
ON CUSTOMER.EMAIL = CAR.MODEL
ON CUSTOMER.BRANCH_ID = CAR.CAR_REGISTRATION_ID)
JOIN LOGBOOK
ON CUSTOMER.FIRST_NAME = LOGBOOK.RENTING_OUT_DATE
ON CUSTOMER.FIRST_NAME = LOGBOOK.RETURNING_DATE;

SELECT FIRST_NAME, TYPE, RENTING_OUT_DATE
FROM (CUSTOMER JOIN CAR
ON CUSTOMER.FIRST_NAME = CAR.TYPE)
JOIN LOGBOOK
ON CUSTOMER.FIRST_NAME = LOGBOOK.RENTING_OUT_DATE;

SELECT CUSTOMER.CUSTOMER_ID, CUSTOMER.FIRST_NAME, CUSTOMER.EMAIL, CUSTOMER.BRANCH_ID, CAR.CAR_TYPE, CAR.CAR_MODEL, CAR.CAR_REGISTRATION_ID, LOGBOOK.RENTING_OUT_DATE, LOGBOOK.RETURNING_DATE, LOGBOOK.TOTAL_PAYMENT
FROM CUSTOMER, CAR, LOGBOOK
WHERE &CONDITION;

SELECT * FROM LOGBOOK
WHERE CUSTOMER_ID = &CUSTOMER_ID;

ALTER TABLE CAR
ADD AVAILABLE VARCHAR(5);

SELECT CUSTOMER.FIRST_NAME, CUSTOMER.EMAIL, LOGBOOK.TOTAL_PAYMENT, LOGBOOK.CAR_REGISTRATION_ID,
LOGBOOK.RENTING_OUT_DATE, LOGBOOK.RETURNING_DATE, CAR.MODEL, CAR.TYPE, CAR.BRANCH_ID
FROM ((LOGBOOK
  INNER JOIN CUSTOMER ON LOGBOOK.CUSTOMER_ID = CUSTOMER.CUSTOMER_ID)
  INNER JOIN CAR ON LOGBOOK.CAR_REGISTRATION_ID = CAR.CAR_REGISTRATION_ID
)
WHERE LOGBOOK.CUSTOMER_ID = &CUSTOMER_ID;

//number 8
select r.CUSTOMER_ID, sum(r.TOTAL_PAYMENT) as custtotal
from LOGBOOK r INNER JOIN customer c on r.CUSTOMER_ID = c.CUSTOMER_ID
where c.BRANCH_ID = '001'
group by r.CUSTOMER_ID
order by custtotal asc;
